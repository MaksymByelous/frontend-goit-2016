angular.module("app.config", [])

.constant("appSettings", {
	"DEV": true,
	"API": {
		"HOST": ""
	},
	"WULIAN_OEM_ID_LENGTH": 12
})

;
(function (ng, _) {
  'use strict';

  var
    underscoreModule = ng.module('angular-underscore', []),
    utilsModule = ng.module('angular-underscore/utils', []),
    filtersModule = ng.module('angular-underscore/filters', []);

  // begin custom _

  function propGetterFactory(prop) {
    return function(obj) {return obj[prop];};
  }

  _._ = _;

  // Shiv "min", "max" ,"sortedIndex" to accept property predicate.
  _.each(['min', 'max', 'sortedIndex'], function(fnName) {
    _[fnName] = _.wrap(_[fnName], function(fn) {
      var args = _.toArray(arguments).slice(1);

      if(_.isString(args[2])) {
        // for "sortedIndex", transmuting str to property getter
        args[2] = propGetterFactory(args[2]);
      }
      else if(_.isString(args[1])) {
        // for "min" or "max", transmuting str to property getter
        args[1] = propGetterFactory(args[1]);
      }

      return fn.apply(_, args);
    });
  });

  // Shiv "filter", "reject" to angular's built-in,
  // and reserve underscore's feature(works on obj).
  ng.injector(['ng']).invoke(['$filter', function($filter) {
    _.filter = _.select = _.wrap($filter('filter'), function(filter, obj, exp, comparator) {
      if(!(_.isArray(obj))) {
        obj = _.toArray(obj);
      }

      return filter(obj, exp, comparator);
    });

    _.reject = function(obj, exp) {
      // use angular built-in negated predicate
      if(_.isString(exp)) {
        return _.filter(obj, '!' + exp);
      }

      var diff = _.bind(_.difference, _, obj);

      return diff(_.filter(obj, exp));
    };
  }]);

  // end custom _


  // begin register angular-underscore/utils

  _.each(_.methods(_), function(methodName) {
    function register($rootScope) {$rootScope[methodName] = _.bind(_[methodName], _);}

    _.each([
      underscoreModule,
      utilsModule,
      ng.module('angular-underscore/utils/' + methodName, [])
      ], function(module) {
        module.run(['$rootScope', register]);
    });
  });

  // end register angular-underscore/utils


  // begin register angular-underscore/filters

  var
    adapList = [
      ['map', 'collect'],
      ['reduce', 'inject', 'foldl'],
      ['reduceRight', 'foldr'],
      ['find', 'detect'],
      ['filter', 'select'],
      'where',
      'findWhere',
      'reject',
      'invoke',
      'pluck',
      'max',
      'min',
      'sortBy',
      'groupBy',
      'indexBy',
      'countBy',
      'shuffle',
      'sample',
      'toArray',
      'size',
      ['first', 'head', 'take'],
      'initial',
      'last',
      ['rest', 'tail', 'drop'],
      'compact',
      'flatten',
      'without',
      'partition',
      'union',
      'intersection',
      'difference',
      ['uniq', 'unique'],
      'zip',
      'object',
      'indexOf',
      'lastIndexOf',
      'sortedIndex',
      'keys',
      'values',
      'pairs',
      'invert',
      ['functions', 'methods'],
      'pick',
      'omit',
      'tap',
      'identity',
      'uniqueId',
      'escape',
      'unescape',
      'result',
      'template'
    ];

  _.each(adapList, function(filterNames) {
    if(!(_.isArray(filterNames))) {
      filterNames = [filterNames];
    }

    var
      filter = _.bind(_[filterNames[0]], _),
      filterFactory = function() {return filter;};

    _.each(filterNames, function(filterName) {
      _.each([
        underscoreModule,
        filtersModule,
        ng.module('angular-underscore/filters/' + filterName, [])
        ], function(module) {
          module.filter(filterName, filterFactory);
      });
    });
  });

  // end register angular-underscore/filters

}(angular, _));

(function(angular) {
  'use strict';
  angular.module('app', [
    'app.config',
    'ngCookies',
    'ui.bootstrap',
    'ui.router',
    'ngSanitize',
    'ngResource',
    'ngAnimate',
    'ngMessages',
    'ngMap',
    'angular-loading-bar',
    'ngTouch',
    'angular-carousel',
    'ngMaterial',
    'duScroll',
    'angular-underscore',
  ])
    .value('duScrollDuration', 1000)
    .value('duScrollOffset', 100)
    .value('duScrollActiveClass', 'active-slide')
    // .value('duScrollEasing', invertedEasingFunction)
    .config(configure)
    .run(runBlock);

  configure.$inject = ['$urlRouterProvider', '$locationProvider', '$httpProvider'];

  function configure($urlRouterProvider, $locationProvider, $httpProvider) {
    $httpProvider.defaults.withCredentials = true;
    $locationProvider.html5Mode({enabled: true, requireBase: false});
    $urlRouterProvider.otherwise('/404');
  }

  runBlock.$inject = ['$rootScope','$state'];

  function runBlock($rootScope, $state) {
    // $rootScope.$on('close-modals', function () {
    //   $uibModalStack.dismissAll();
    // });
    $rootScope.canonical = '/';
    $rootScope.$state = $state;
    $rootScope.$on('$stateChangeError', function(error) {
      console.log(error);
    });
    $rootScope.$on('$stateChangeSuccess', function(event, toState, toParams, fromState) {
      $rootScope.pageTitle = toState.data && toState.data.title ? toState.data.title : 'test task';
      angular.element('body').scrollTop(0);
    });
    $rootScope.broadcastScrollEvent = function () {
      $rootScope.$broadcast('scroll');
    };
  }
})(angular);

(function (angular) {
  "use strict";
  angular.module('app').factory('HomeService', HomeService);

  HomeService.$inject = [];

  function HomeService() {

    var news = [
        {
          title: 'Partnership for future without lie',
          titleFoto:'/img/news/news3-title.jpg',
          description: "Award-winning investigative journalist Diane Francis with Kira Rudik, Verified, Management and Operations, united their common forces to develop a project...",
          detailedDescription: {
            paragraph1: "Award-winning investigative journalist Diane Francis with Kira Rudik, Verified, Management and Operations, united their common forces to develop a project aimed to help people to find true statements in our fast-changing information society.",
            paragraph2: "It will be a real-time fact checking tool verifying statement and then receiving a rating about the accuracy of this ‘fact.’ Fact checking enables us to sort through a tidal wave of massive information and communication."
          },
          day: '',
          month: 'June',
          year: '2017',
          image: '/img/news/news3.jpg'
        },
        {
          title: 'Vsevolod Dyomkin about Verified Prototype',
          titleFoto:'/img/news/news2-title.jpg',
          description: "Verified is a prototype of the program that can determine whether the news is true or fake. The program checks the text for inconsistencies. The question is...",
          detailedDescription: {
            paragraph1: "Verified is a prototype of the program that can determine whether the news is true or fake. The program checks the text for inconsistencies. The question is “How the program works?”. There is a special field to enter the text: claims or quotes. After entering, the prototype compares it with other web sources.",
            paragraph2: "The program analyses data and finds confirmation or refutation. As the result, we get information that can confirm or refute this claim. If the result was not found, the claim is not confirmed. Verified goal is to help our society to identify the fake news and find the truth."
          },
          day: '',
          month: 'May',
          year: '2017',
          image: '/img/news/news2.jpg'
        },
        {
          title: 'The meet-up “Features and models of NLP"',
          titleFoto:'/img/news/news1-title.jpg',
          description: "The meet-up 'What features and models do work in NLP and why' was held on February, 10 by Vsevolod Dyomkin, Lisp Engineer, independent developer and expert in NLP.",
          detailedDescription: {
            paragraph1: "The meet-up 'What features and models do work in NLP and why' was held on February, 10 by Vsevolod Dyomkin, Lisp Engineer, independent developer and expert in NLP.",
            paragraph2: "Vsevolod spoke about linear models, random forest, RNN, morphological features, 1-hot encoding and word-embeddings. Meet-up was intended on audience with good experience in ML, who wanted to learn new information."
          },
          day: '10',
          month: 'February',
          year: '2017',
          image: '/img/news/news1.jpg'
        }
      ];

  return {
    news: news
  };
}
})
(angular);

(function (angular) {
  "use strict";
  angular.module('app').factory('TeamService', TeamService);

  TeamService.$inject = [];

  function TeamService() {

    var directors = [
      { name: 'Diane Francis',
        position:'Author, Professional Corporate Director, Professor, Entrepreneur, expert on Silicon Valley, future technology',
        image: 'fransis.jpg'
      },
      { name: 'Jason Mitura',
        position:'Serial Venture Capitalist, Viewdle',
        image: 'jason.jpg'
      },
      { name: 'Kira	Rudik',
        position:'Management and Operations',
        image: 'kira.jpg'
      },
      { name: 'Vsevolod Dyomkin',
        position:'World-Class researcher, Kyiv Polytechnic lecturer, 5 years NLP with Grammarly',
        image: 'dyomkin.jpg'
      }
    ];
    var team = [
        {name: 'Taras', position:'Researcher', image: 'taras-sereda-0006.jpg'},
        {name: 'Aleksandr', position:'Full Stack Developer', image: 'alex-lapshyn.jpg'}
      ];

    return {
      team: team,
      directors: directors
    };
  }
})(angular);

(function (angular) {
  "use strict";
  angular.module('app').factory('WindowEventsService', WindowEventsService);

  WindowEventsService.$inject = ['$window'];

  function WindowEventsService($window) {
    var api = {
      throttleTime: 100,
      listen: listen
    };

    //listener updates
    function listen(isOn, type, method, time) {

      //clean time, determine listener type
      var debounceTime = isNaN(time) ? api.throttleTime : time,
        listenerType = isOn ? 'addEventListener' : 'removeEventListener';

      //update throttled listener
      $window[listenerType](type, _.throttle(method, debounceTime));
    }

    //interface
    return api;
  }
})(angular);
angular.module('app').directive('onScroll', ["$timeout", function($timeout) {
  'use strict';

  return {
    scope: {
      onScroll: '&onScroll',
    },
    link: function(scope, element) {
      var scrollDelay = 250,
        scrollThrottleTimeout,
        throttled = false,
        scrollHandler = function() {
          if (!throttled) {
            scope.onScroll();
            throttled = true;
            scrollThrottleTimeout = $timeout(function(){
              throttled = false;
            }, scrollDelay);
          }
        };

      element.on("scroll", scrollHandler);

      scope.$on('$destroy', function() {
        element.off('scroll', scrollHandler);
      });
    }
  };
}]);

(function(angular) {
  'use strict';
  angular.module('app').controller('LandingController', LandingController);

  LandingController.$inject = ['$http', 'limitToFilter'];
  function LandingController($http, limitToFilter) {
    var main = this;

    main.formSubmit = formSubmit;
    main.error = 'something wrong';
    main.formData = {};
    main.showStep2 = false;
    main.showStep3 = false;

    main.minYears = 7671;
    main.dif70yers = 25569;
    main.todayDate = new Date();
    // main.todayMS = main.todayDate.getTime();
    main.todayDays =  main.todayDate.getTime() / 86400000;
    main.ageCheck = ageCheck;
    main.ageInvalid = false;

    function ageCheck() {
      main.innStr = main.formData.inn.toString().substring(0, 5);
      main.ageCheckRes = main.todayDays + main.dif70yers - main.innStr;
      if (main.ageCheckRes >  main.minYears) {
        main.ageInvalid = false;
        return true;
      }   else {
        main.ageInvalid = true;
        return false;
      }
    }

    function formSubmit() {
      $http({
          url: '/',
          method: "POST",
          data: main.formData,
          headers: {'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;'}
          }).then(function successCallback(response) {
              alert('data sent');
          }, function errorCallback() {
              alert("something wrong");
            });
    }

    main.getCities = getCities;
    function getCities() {

      $http.get("http://gd.geobytes.com/AutoCompleteCity?callback=?&q=" + main.formData.city).then(function (response) {
        console.log(response);
        // main.cities = limitToFilter(response.data, 15);
      });
    }
  }

})(angular);

(function(angular) {
  'use strict';
  angular.module('app').config(landingRoute);
  landingRoute.$inject = ['$stateProvider'];

  function landingRoute($stateProvider) {
    $stateProvider.state('landing', {
      abstract: true,
      templateUrl: '/view/modules/landing/landing.html',
      controller: 'LandingController',
      controllerAs: 'main'

    });
  }
})(angular);

(function (angular) {
  'use strict';
  angular.module('app').controller('LandingHomeController', LandingHomeController);


  LandingHomeController.$inject = ['$document', '$scope', '$window', 'WindowEventsService',
    'HomeService', '$stateParams', '$timeout', 'TeamService'];
  function LandingHomeController($document, $scope, $window, WindowEventsService,
                                 HomeService, $stateParams, $timeout, TeamService) {
    var vm = this;

    vm.scrollTo = scrollTo;


    function scrollTo(elementIndex) {
      $timeout(function () {
        $document.scrollToElementAnimated(vm.sections[elementIndex].element, 0);
      }, 100);
    }

    function getElementsHeight() {
      vm.eventsGridHeight = angular.element(document.getElementById('events-grid'))[0].clientHeight;
    }

  }

})(angular);

(function(angular) {
  'use strict';
  angular.module('app').config(landingHomeRoute);
  landingHomeRoute.$inject = ['$stateProvider'];

  function landingHomeRoute($stateProvider) {
    $stateProvider.state('landing.home', {
      url: '/',
      templateUrl: '/view/modules/landing/home/home.html',
      controller: 'LandingHomeController',
      controllerAs: 'vm',
      data: {
        title: 'test task'
      },
      params: {
        targetSectionName: 'main'
      }
    });
  }
})(angular);

(function(angular) {
  'use strict';
  angular.module('app').controller('LandingPage2Controller', LandingPage2Controller);

  LandingPage2Controller.$inject = ['$document', 'WindowEventsService', '$window', '$scope', '$timeout',
  'HomeService', '$stateParams'];
  function LandingPage2Controller($document, WindowEventsService, $window, $scope, $timeout,
     HomeService, $stateParams) {
    var vm = this;

    vm.scrollY = 0;
    vm.menuIsOpen = false;
    vm.toggleMobileMenu = toggleMobileMenu;
    vm.scrollTo = scrollTo;
    vm.windowWidth = $window.innerWidth;
    vm.windowHeight = $window.innerHeight;
    vm.windowY = 0;
    vm.news = HomeService.news;
    vm.newsLeftOut = vm.windowWidth * 0.29;
    vm.newsItemWidth = 400;
    vm.newsListWidth = vm.news.length * vm.newsItemWidth;
    vm.newsLeft = newsLeft;
    vm.newsRight = newsRight;
    vm.openNews = {};
    vm.detailedNewsOpened = false;
    vm.newsDetalsToggle = newsDetalsToggle;
    vm.leftArrowHovered = false;
    vm.rightArrowHovered = false;

    WindowEventsService.listen(true, 'scroll', defineScrollY);

    function defineScrollY() {
      vm.scrollY = $window.scrollY;
      $scope.$apply();
    }

    function scrollTo(sectionName) {
      $document.scrollToElementAnimated(vm.sections[sectionName].element);
    }

    function toggleMobileMenu() {
      vm.menuIsOpen = !vm.menuIsOpen;
    }


    if (vm.windowWidth < 700) {
      vm.newsLeftOut = 2;
      vm.newsItemWidth = 330;
    }

    function checkWindowWidth(){
        vm.windowWidth = $window.innerWidth;
        $timeout( checkWindowWidth, 200 );
    }
    checkWindowWidth();

    function eventDetails(event) {
      vm.selectedEvent = event;
      vm.showEventDetails = true;
    }

    function newsLeft() {
      if (vm.windowWidth > 700) {
        if(  (vm.newsListWidth + vm.newsLeftOut) < (vm.newsItemWidth * 2.5)  ) {
          vm.newsLeftOut = vm.windowWidth * 0.29;
        } else {
          vm.newsLeftOut -= vm.newsItemWidth;
        }
      } else {
        if(  (vm.newsListWidth + vm.newsLeftOut) < (vm.newsItemWidth*2.5)  ) {
          vm.newsLeftOut = 2;
        } else {
          vm.newsLeftOut -= vm.newsItemWidth;
        }
      }
    }

    function newsRight() {
      if (vm.windowWidth > 700) {
        if(  (vm.newsLeftOut/vm.windowWidth) > 0.73  ) {
          vm.newsLeftOut = vm.windowWidth * 0.29;
        } else {
          vm.newsLeftOut += vm.newsItemWidth;
        }
      } else {
        if(  vm.newsLeftOut < 3 && vm.newsLeftOut > -100  ) {
          vm.newsLeftOut = - vm.newsItemWidth * (vm.news.length - 1);
        } else {
          vm.newsLeftOut += vm.newsItemWidth;
        }
      }
    }

    function newsDetalsToggle() {
       vm.detailedNewsOpened = !vm.detailedNewsOpened;
    }

  }
})(angular);

(function(angular) {
  'use strict';
  angular.module('app').config(landingPage2Route);
  landingPage2Route.$inject = ['$stateProvider'];

  function landingPage2Route($stateProvider) {
    $stateProvider.state('landing.page2', {
      url: '/page2',
      templateUrl: '/view/modules/landing/page2/page2.html',
      controller: 'LandingPage2Controller',
      controllerAs: 'vm',
      data: {
        title: 'page 2'
      }
    });
  }
})(angular);

(function(angular) {
  'use strict';
  angular.module('app').controller('LandingPage3Controller', LandingPage3Controller);

  LandingPage3Controller.$inject = ['$document', 'WindowEventsService', '$window', '$scope', '$timeout',
  'TeamService', '$stateParams'];
  function LandingPage3Controller($document, WindowEventsService, $window, $scope, $timeout,
     TeamService, $stateParams) {
    var vm = this;

    vm.scrollY = 0;
    vm.menuIsOpen = false;
    vm.toggleMobileMenu = toggleMobileMenu;
    vm.scrollTo = scrollTo;
    vm.windowWidth = $window.innerWidth;
    vm.windowHeight = $window.innerHeight;
    vm.windowY = 0;
    vm.directors = TeamService.directors;
    vm.staff = TeamService.team;

    WindowEventsService.listen(true, 'scroll', defineScrollY);

    function defineScrollY() {
      vm.scrollY = $window.scrollY;
      $scope.$apply();
    }

    function scrollTo(sectionName) {
      $document.scrollToElementAnimated(vm.sections[sectionName].element);
    }

    function toggleMobileMenu() {
      vm.menuIsOpen = !vm.menuIsOpen;
    }

  }
})(angular);

(function(angular) {
  'use strict';
  angular.module('app').config(landingPage3Route);
  landingPage3Route.$inject = ['$stateProvider'];

  function landingPage3Route($stateProvider) {
    $stateProvider.state('landing.page3', {
      url: '/page3',
      templateUrl: '/view/modules/landing/page3/page3.html',
      controller: 'LandingPage3Controller',
      controllerAs: 'vm',
      data: {
        title: 'page 3'
      }
    });
  }
})(angular);

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvY2FsLmpzIiwiYW5ndWxhci11bmRlcnNjb3JlLmpzIiwibWFpbi5qcyIsInNlcnZpY2VzL2hvbWUuc2VydmljZS5qcyIsInNlcnZpY2VzL3RlYW0uc2VydmljZS5qcyIsInNlcnZpY2VzL3dpbmRvdy1ldmVudHMtc2VydmljZS5qcyIsImNvbXBvbmVudHMvZGlyZWN0aXZlcy9vbi1zY3JvbGwuanMiLCJtb2R1bGVzL2xhbmRpbmcvbGFuZGluZy5jdHJsLmpzIiwibW9kdWxlcy9sYW5kaW5nL2xhbmRpbmcucm91dGUuanMiLCJtb2R1bGVzL2xhbmRpbmcvaG9tZS9ob21lLmN0cmwuanMiLCJtb2R1bGVzL2xhbmRpbmcvaG9tZS9ob21lLnJvdXRlLmpzIiwibW9kdWxlcy9sYW5kaW5nL3BhZ2UyL3BhZ2UyLmN0cmwuanMiLCJtb2R1bGVzL2xhbmRpbmcvcGFnZTIvcGFnZTIucm91dGUuanMiLCJtb2R1bGVzL2xhbmRpbmcvcGFnZTMvcGFnZTMuY3RybC5qcyIsIm1vZHVsZXMvbGFuZGluZy9wYWdlMy9wYWdlMy5yb3V0ZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxRQUFBLE9BQUEsY0FBQTs7Q0FFQSxTQUFBLGVBQUE7Q0FDQSxPQUFBO0NBQ0EsT0FBQTtFQUNBLFFBQUE7O0NBRUEsd0JBQUE7Ozs7QUNQQSxDQUFBLFVBQUEsSUFBQSxHQUFBO0VBQ0E7O0VBRUE7SUFDQSxtQkFBQSxHQUFBLE9BQUEsc0JBQUE7SUFDQSxjQUFBLEdBQUEsT0FBQSw0QkFBQTtJQUNBLGdCQUFBLEdBQUEsT0FBQSw4QkFBQTs7OztFQUlBLFNBQUEsa0JBQUEsTUFBQTtJQUNBLE9BQUEsU0FBQSxLQUFBLENBQUEsT0FBQSxJQUFBOzs7RUFHQSxFQUFBLElBQUE7OztFQUdBLEVBQUEsS0FBQSxDQUFBLE9BQUEsT0FBQSxnQkFBQSxTQUFBLFFBQUE7SUFDQSxFQUFBLFVBQUEsRUFBQSxLQUFBLEVBQUEsU0FBQSxTQUFBLElBQUE7TUFDQSxJQUFBLE9BQUEsRUFBQSxRQUFBLFdBQUEsTUFBQTs7TUFFQSxHQUFBLEVBQUEsU0FBQSxLQUFBLEtBQUE7O1FBRUEsS0FBQSxLQUFBLGtCQUFBLEtBQUE7O1dBRUEsR0FBQSxFQUFBLFNBQUEsS0FBQSxLQUFBOztRQUVBLEtBQUEsS0FBQSxrQkFBQSxLQUFBOzs7TUFHQSxPQUFBLEdBQUEsTUFBQSxHQUFBOzs7Ozs7RUFNQSxHQUFBLFNBQUEsQ0FBQSxPQUFBLE9BQUEsQ0FBQSxXQUFBLFNBQUEsU0FBQTtJQUNBLEVBQUEsU0FBQSxFQUFBLFNBQUEsRUFBQSxLQUFBLFFBQUEsV0FBQSxTQUFBLFFBQUEsS0FBQSxLQUFBLFlBQUE7TUFDQSxHQUFBLEVBQUEsRUFBQSxRQUFBLE9BQUE7UUFDQSxNQUFBLEVBQUEsUUFBQTs7O01BR0EsT0FBQSxPQUFBLEtBQUEsS0FBQTs7O0lBR0EsRUFBQSxTQUFBLFNBQUEsS0FBQSxLQUFBOztNQUVBLEdBQUEsRUFBQSxTQUFBLE1BQUE7UUFDQSxPQUFBLEVBQUEsT0FBQSxLQUFBLE1BQUE7OztNQUdBLElBQUEsT0FBQSxFQUFBLEtBQUEsRUFBQSxZQUFBLEdBQUE7O01BRUEsT0FBQSxLQUFBLEVBQUEsT0FBQSxLQUFBOzs7Ozs7Ozs7RUFTQSxFQUFBLEtBQUEsRUFBQSxRQUFBLElBQUEsU0FBQSxZQUFBO0lBQ0EsU0FBQSxTQUFBLFlBQUEsQ0FBQSxXQUFBLGNBQUEsRUFBQSxLQUFBLEVBQUEsYUFBQTs7SUFFQSxFQUFBLEtBQUE7TUFDQTtNQUNBO01BQ0EsR0FBQSxPQUFBLDhCQUFBLFlBQUE7U0FDQSxTQUFBLFFBQUE7UUFDQSxPQUFBLElBQUEsQ0FBQSxjQUFBOzs7Ozs7Ozs7RUFTQTtJQUNBLFdBQUE7TUFDQSxDQUFBLE9BQUE7TUFDQSxDQUFBLFVBQUEsVUFBQTtNQUNBLENBQUEsZUFBQTtNQUNBLENBQUEsUUFBQTtNQUNBLENBQUEsVUFBQTtNQUNBO01BQ0E7TUFDQTtNQUNBO01BQ0E7TUFDQTtNQUNBO01BQ0E7TUFDQTtNQUNBO01BQ0E7TUFDQTtNQUNBO01BQ0E7TUFDQTtNQUNBLENBQUEsU0FBQSxRQUFBO01BQ0E7TUFDQTtNQUNBLENBQUEsUUFBQSxRQUFBO01BQ0E7TUFDQTtNQUNBO01BQ0E7TUFDQTtNQUNBO01BQ0E7TUFDQSxDQUFBLFFBQUE7TUFDQTtNQUNBO01BQ0E7TUFDQTtNQUNBO01BQ0E7TUFDQTtNQUNBO01BQ0E7TUFDQSxDQUFBLGFBQUE7TUFDQTtNQUNBO01BQ0E7TUFDQTtNQUNBO01BQ0E7TUFDQTtNQUNBO01BQ0E7OztFQUdBLEVBQUEsS0FBQSxVQUFBLFNBQUEsYUFBQTtJQUNBLEdBQUEsRUFBQSxFQUFBLFFBQUEsZUFBQTtNQUNBLGNBQUEsQ0FBQTs7O0lBR0E7TUFDQSxTQUFBLEVBQUEsS0FBQSxFQUFBLFlBQUEsS0FBQTtNQUNBLGdCQUFBLFdBQUEsQ0FBQSxPQUFBOztJQUVBLEVBQUEsS0FBQSxhQUFBLFNBQUEsWUFBQTtNQUNBLEVBQUEsS0FBQTtRQUNBO1FBQ0E7UUFDQSxHQUFBLE9BQUEsZ0NBQUEsWUFBQTtXQUNBLFNBQUEsUUFBQTtVQUNBLE9BQUEsT0FBQSxZQUFBOzs7Ozs7O0VBT0EsU0FBQTs7QUM1SkEsQ0FBQSxTQUFBLFNBQUE7RUFDQTtFQUNBLFFBQUEsT0FBQSxPQUFBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBOztLQUVBLE1BQUEsb0JBQUE7S0FDQSxNQUFBLGtCQUFBO0tBQ0EsTUFBQSx1QkFBQTs7S0FFQSxPQUFBO0tBQ0EsSUFBQTs7RUFFQSxVQUFBLFVBQUEsQ0FBQSxzQkFBQSxxQkFBQTs7RUFFQSxTQUFBLFVBQUEsb0JBQUEsbUJBQUEsZUFBQTtJQUNBLGNBQUEsU0FBQSxrQkFBQTtJQUNBLGtCQUFBLFVBQUEsQ0FBQSxTQUFBLE1BQUEsYUFBQTtJQUNBLG1CQUFBLFVBQUE7OztFQUdBLFNBQUEsVUFBQSxDQUFBLGFBQUE7O0VBRUEsU0FBQSxTQUFBLFlBQUEsUUFBQTs7OztJQUlBLFdBQUEsWUFBQTtJQUNBLFdBQUEsU0FBQTtJQUNBLFdBQUEsSUFBQSxxQkFBQSxTQUFBLE9BQUE7TUFDQSxRQUFBLElBQUE7O0lBRUEsV0FBQSxJQUFBLHVCQUFBLFNBQUEsT0FBQSxTQUFBLFVBQUEsV0FBQTtNQUNBLFdBQUEsWUFBQSxRQUFBLFFBQUEsUUFBQSxLQUFBLFFBQUEsUUFBQSxLQUFBLFFBQUE7TUFDQSxRQUFBLFFBQUEsUUFBQSxVQUFBOztJQUVBLFdBQUEsdUJBQUEsWUFBQTtNQUNBLFdBQUEsV0FBQTs7O0dBR0E7O0FDckRBLENBQUEsVUFBQSxTQUFBO0VBQ0E7RUFDQSxRQUFBLE9BQUEsT0FBQSxRQUFBLGVBQUE7O0VBRUEsWUFBQSxVQUFBOztFQUVBLFNBQUEsY0FBQTs7SUFFQSxJQUFBLE9BQUE7UUFDQTtVQUNBLE9BQUE7VUFDQSxVQUFBO1VBQ0EsYUFBQTtVQUNBLHFCQUFBO1lBQ0EsWUFBQTtZQUNBLFlBQUE7O1VBRUEsS0FBQTtVQUNBLE9BQUE7VUFDQSxNQUFBO1VBQ0EsT0FBQTs7UUFFQTtVQUNBLE9BQUE7VUFDQSxVQUFBO1VBQ0EsYUFBQTtVQUNBLHFCQUFBO1lBQ0EsWUFBQTtZQUNBLFlBQUE7O1VBRUEsS0FBQTtVQUNBLE9BQUE7VUFDQSxNQUFBO1VBQ0EsT0FBQTs7UUFFQTtVQUNBLE9BQUE7VUFDQSxVQUFBO1VBQ0EsYUFBQTtVQUNBLHFCQUFBO1lBQ0EsWUFBQTtZQUNBLFlBQUE7O1VBRUEsS0FBQTtVQUNBLE9BQUE7VUFDQSxNQUFBO1VBQ0EsT0FBQTs7OztFQUlBLE9BQUE7SUFDQSxNQUFBOzs7O0NBSUE7O0FDdkRBLENBQUEsVUFBQSxTQUFBO0VBQ0E7RUFDQSxRQUFBLE9BQUEsT0FBQSxRQUFBLGVBQUE7O0VBRUEsWUFBQSxVQUFBOztFQUVBLFNBQUEsY0FBQTs7SUFFQSxJQUFBLFlBQUE7TUFDQSxFQUFBLE1BQUE7UUFDQSxTQUFBO1FBQ0EsT0FBQTs7TUFFQSxFQUFBLE1BQUE7UUFDQSxTQUFBO1FBQ0EsT0FBQTs7TUFFQSxFQUFBLE1BQUE7UUFDQSxTQUFBO1FBQ0EsT0FBQTs7TUFFQSxFQUFBLE1BQUE7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LCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKFwiYXBwLmNvbmZpZ1wiLCBbXSlcblxuLmNvbnN0YW50KFwiYXBwU2V0dGluZ3NcIiwge1xuXHRcIkRFVlwiOiB0cnVlLFxuXHRcIkFQSVwiOiB7XG5cdFx0XCJIT1NUXCI6IFwiXCJcblx0fSxcblx0XCJXVUxJQU5fT0VNX0lEX0xFTkdUSFwiOiAxMlxufSlcblxuOyIsIihmdW5jdGlvbiAobmcsIF8pIHtcclxuICAndXNlIHN0cmljdCc7XHJcblxyXG4gIHZhclxyXG4gICAgdW5kZXJzY29yZU1vZHVsZSA9IG5nLm1vZHVsZSgnYW5ndWxhci11bmRlcnNjb3JlJywgW10pLFxyXG4gICAgdXRpbHNNb2R1bGUgPSBuZy5tb2R1bGUoJ2FuZ3VsYXItdW5kZXJzY29yZS91dGlscycsIFtdKSxcclxuICAgIGZpbHRlcnNNb2R1bGUgPSBuZy5tb2R1bGUoJ2FuZ3VsYXItdW5kZXJzY29yZS9maWx0ZXJzJywgW10pO1xyXG5cclxuICAvLyBiZWdpbiBjdXN0b20gX1xyXG5cclxuICBmdW5jdGlvbiBwcm9wR2V0dGVyRmFjdG9yeShwcm9wKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24ob2JqKSB7cmV0dXJuIG9ialtwcm9wXTt9O1xyXG4gIH1cclxuXHJcbiAgXy5fID0gXztcclxuXHJcbiAgLy8gU2hpdiBcIm1pblwiLCBcIm1heFwiICxcInNvcnRlZEluZGV4XCIgdG8gYWNjZXB0IHByb3BlcnR5IHByZWRpY2F0ZS5cclxuICBfLmVhY2goWydtaW4nLCAnbWF4JywgJ3NvcnRlZEluZGV4J10sIGZ1bmN0aW9uKGZuTmFtZSkge1xyXG4gICAgX1tmbk5hbWVdID0gXy53cmFwKF9bZm5OYW1lXSwgZnVuY3Rpb24oZm4pIHtcclxuICAgICAgdmFyIGFyZ3MgPSBfLnRvQXJyYXkoYXJndW1lbnRzKS5zbGljZSgxKTtcclxuXHJcbiAgICAgIGlmKF8uaXNTdHJpbmcoYXJnc1syXSkpIHtcclxuICAgICAgICAvLyBmb3IgXCJzb3J0ZWRJbmRleFwiLCB0cmFuc211dGluZyBzdHIgdG8gcHJvcGVydHkgZ2V0dGVyXHJcbiAgICAgICAgYXJnc1syXSA9IHByb3BHZXR0ZXJGYWN0b3J5KGFyZ3NbMl0pO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYoXy5pc1N0cmluZyhhcmdzWzFdKSkge1xyXG4gICAgICAgIC8vIGZvciBcIm1pblwiIG9yIFwibWF4XCIsIHRyYW5zbXV0aW5nIHN0ciB0byBwcm9wZXJ0eSBnZXR0ZXJcclxuICAgICAgICBhcmdzWzFdID0gcHJvcEdldHRlckZhY3RvcnkoYXJnc1sxXSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBmbi5hcHBseShfLCBhcmdzKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICAvLyBTaGl2IFwiZmlsdGVyXCIsIFwicmVqZWN0XCIgdG8gYW5ndWxhcidzIGJ1aWx0LWluLFxyXG4gIC8vIGFuZCByZXNlcnZlIHVuZGVyc2NvcmUncyBmZWF0dXJlKHdvcmtzIG9uIG9iaikuXHJcbiAgbmcuaW5qZWN0b3IoWyduZyddKS5pbnZva2UoWyckZmlsdGVyJywgZnVuY3Rpb24oJGZpbHRlcikge1xyXG4gICAgXy5maWx0ZXIgPSBfLnNlbGVjdCA9IF8ud3JhcCgkZmlsdGVyKCdmaWx0ZXInKSwgZnVuY3Rpb24oZmlsdGVyLCBvYmosIGV4cCwgY29tcGFyYXRvcikge1xyXG4gICAgICBpZighKF8uaXNBcnJheShvYmopKSkge1xyXG4gICAgICAgIG9iaiA9IF8udG9BcnJheShvYmopO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gZmlsdGVyKG9iaiwgZXhwLCBjb21wYXJhdG9yKTtcclxuICAgIH0pO1xyXG5cclxuICAgIF8ucmVqZWN0ID0gZnVuY3Rpb24ob2JqLCBleHApIHtcclxuICAgICAgLy8gdXNlIGFuZ3VsYXIgYnVpbHQtaW4gbmVnYXRlZCBwcmVkaWNhdGVcclxuICAgICAgaWYoXy5pc1N0cmluZyhleHApKSB7XHJcbiAgICAgICAgcmV0dXJuIF8uZmlsdGVyKG9iaiwgJyEnICsgZXhwKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIGRpZmYgPSBfLmJpbmQoXy5kaWZmZXJlbmNlLCBfLCBvYmopO1xyXG5cclxuICAgICAgcmV0dXJuIGRpZmYoXy5maWx0ZXIob2JqLCBleHApKTtcclxuICAgIH07XHJcbiAgfV0pO1xyXG5cclxuICAvLyBlbmQgY3VzdG9tIF9cclxuXHJcblxyXG4gIC8vIGJlZ2luIHJlZ2lzdGVyIGFuZ3VsYXItdW5kZXJzY29yZS91dGlsc1xyXG5cclxuICBfLmVhY2goXy5tZXRob2RzKF8pLCBmdW5jdGlvbihtZXRob2ROYW1lKSB7XHJcbiAgICBmdW5jdGlvbiByZWdpc3Rlcigkcm9vdFNjb3BlKSB7JHJvb3RTY29wZVttZXRob2ROYW1lXSA9IF8uYmluZChfW21ldGhvZE5hbWVdLCBfKTt9XHJcblxyXG4gICAgXy5lYWNoKFtcclxuICAgICAgdW5kZXJzY29yZU1vZHVsZSxcclxuICAgICAgdXRpbHNNb2R1bGUsXHJcbiAgICAgIG5nLm1vZHVsZSgnYW5ndWxhci11bmRlcnNjb3JlL3V0aWxzLycgKyBtZXRob2ROYW1lLCBbXSlcclxuICAgICAgXSwgZnVuY3Rpb24obW9kdWxlKSB7XHJcbiAgICAgICAgbW9kdWxlLnJ1bihbJyRyb290U2NvcGUnLCByZWdpc3Rlcl0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIC8vIGVuZCByZWdpc3RlciBhbmd1bGFyLXVuZGVyc2NvcmUvdXRpbHNcclxuXHJcblxyXG4gIC8vIGJlZ2luIHJlZ2lzdGVyIGFuZ3VsYXItdW5kZXJzY29yZS9maWx0ZXJzXHJcblxyXG4gIHZhclxyXG4gICAgYWRhcExpc3QgPSBbXHJcbiAgICAgIFsnbWFwJywgJ2NvbGxlY3QnXSxcclxuICAgICAgWydyZWR1Y2UnLCAnaW5qZWN0JywgJ2ZvbGRsJ10sXHJcbiAgICAgIFsncmVkdWNlUmlnaHQnLCAnZm9sZHInXSxcclxuICAgICAgWydmaW5kJywgJ2RldGVjdCddLFxyXG4gICAgICBbJ2ZpbHRlcicsICdzZWxlY3QnXSxcclxuICAgICAgJ3doZXJlJyxcclxuICAgICAgJ2ZpbmRXaGVyZScsXHJcbiAgICAgICdyZWplY3QnLFxyXG4gICAgICAnaW52b2tlJyxcclxuICAgICAgJ3BsdWNrJyxcclxuICAgICAgJ21heCcsXHJcbiAgICAgICdtaW4nLFxyXG4gICAgICAnc29ydEJ5JyxcclxuICAgICAgJ2dyb3VwQnknLFxyXG4gICAgICAnaW5kZXhCeScsXHJcbiAgICAgICdjb3VudEJ5JyxcclxuICAgICAgJ3NodWZmbGUnLFxyXG4gICAgICAnc2FtcGxlJyxcclxuICAgICAgJ3RvQXJyYXknLFxyXG4gICAgICAnc2l6ZScsXHJcbiAgICAgIFsnZmlyc3QnLCAnaGVhZCcsICd0YWtlJ10sXHJcbiAgICAgICdpbml0aWFsJyxcclxuICAgICAgJ2xhc3QnLFxyXG4gICAgICBbJ3Jlc3QnLCAndGFpbCcsICdkcm9wJ10sXHJcbiAgICAgICdjb21wYWN0JyxcclxuICAgICAgJ2ZsYXR0ZW4nLFxyXG4gICAgICAnd2l0aG91dCcsXHJcbiAgICAgICdwYXJ0aXRpb24nLFxyXG4gICAgICAndW5pb24nLFxyXG4gICAgICAnaW50ZXJzZWN0aW9uJyxcclxuICAgICAgJ2RpZmZlcmVuY2UnLFxyXG4gICAgICBbJ3VuaXEnLCAndW5pcXVlJ10sXHJcbiAgICAgICd6aXAnLFxyXG4gICAgICAnb2JqZWN0JyxcclxuICAgICAgJ2luZGV4T2YnLFxyXG4gICAgICAnbGFzdEluZGV4T2YnLFxyXG4gICAgICAnc29ydGVkSW5kZXgnLFxyXG4gICAgICAna2V5cycsXHJcbiAgICAgICd2YWx1ZXMnLFxyXG4gICAgICAncGFpcnMnLFxyXG4gICAgICAnaW52ZXJ0JyxcclxuICAgICAgWydmdW5jdGlvbnMnLCAnbWV0aG9kcyddLFxyXG4gICAgICAncGljaycsXHJcbiAgICAgICdvbWl0JyxcclxuICAgICAgJ3RhcCcsXHJcbiAgICAgICdpZGVudGl0eScsXHJcbiAgICAgICd1bmlxdWVJZCcsXHJcbiAgICAgICdlc2NhcGUnLFxyXG4gICAgICAndW5lc2NhcGUnLFxyXG4gICAgICAncmVzdWx0JyxcclxuICAgICAgJ3RlbXBsYXRlJ1xyXG4gICAgXTtcclxuXHJcbiAgXy5lYWNoKGFkYXBMaXN0LCBmdW5jdGlvbihmaWx0ZXJOYW1lcykge1xyXG4gICAgaWYoIShfLmlzQXJyYXkoZmlsdGVyTmFtZXMpKSkge1xyXG4gICAgICBmaWx0ZXJOYW1lcyA9IFtmaWx0ZXJOYW1lc107XHJcbiAgICB9XHJcblxyXG4gICAgdmFyXHJcbiAgICAgIGZpbHRlciA9IF8uYmluZChfW2ZpbHRlck5hbWVzWzBdXSwgXyksXHJcbiAgICAgIGZpbHRlckZhY3RvcnkgPSBmdW5jdGlvbigpIHtyZXR1cm4gZmlsdGVyO307XHJcblxyXG4gICAgXy5lYWNoKGZpbHRlck5hbWVzLCBmdW5jdGlvbihmaWx0ZXJOYW1lKSB7XHJcbiAgICAgIF8uZWFjaChbXHJcbiAgICAgICAgdW5kZXJzY29yZU1vZHVsZSxcclxuICAgICAgICBmaWx0ZXJzTW9kdWxlLFxyXG4gICAgICAgIG5nLm1vZHVsZSgnYW5ndWxhci11bmRlcnNjb3JlL2ZpbHRlcnMvJyArIGZpbHRlck5hbWUsIFtdKVxyXG4gICAgICAgIF0sIGZ1bmN0aW9uKG1vZHVsZSkge1xyXG4gICAgICAgICAgbW9kdWxlLmZpbHRlcihmaWx0ZXJOYW1lLCBmaWx0ZXJGYWN0b3J5KTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgLy8gZW5kIHJlZ2lzdGVyIGFuZ3VsYXItdW5kZXJzY29yZS9maWx0ZXJzXHJcblxyXG59KGFuZ3VsYXIsIF8pKTtcclxuIiwiKGZ1bmN0aW9uKGFuZ3VsYXIpIHtcclxuICAndXNlIHN0cmljdCc7XHJcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcclxuICAgICdhcHAuY29uZmlnJyxcclxuICAgICduZ0Nvb2tpZXMnLFxyXG4gICAgJ3VpLmJvb3RzdHJhcCcsXHJcbiAgICAndWkucm91dGVyJyxcclxuICAgICduZ1Nhbml0aXplJyxcclxuICAgICduZ1Jlc291cmNlJyxcclxuICAgICduZ0FuaW1hdGUnLFxyXG4gICAgJ25nTWVzc2FnZXMnLFxyXG4gICAgJ25nTWFwJyxcclxuICAgICdhbmd1bGFyLWxvYWRpbmctYmFyJyxcclxuICAgICduZ1RvdWNoJyxcclxuICAgICdhbmd1bGFyLWNhcm91c2VsJyxcclxuICAgICduZ01hdGVyaWFsJyxcclxuICAgICdkdVNjcm9sbCcsXHJcbiAgICAnYW5ndWxhci11bmRlcnNjb3JlJyxcclxuICBdKVxyXG4gICAgLnZhbHVlKCdkdVNjcm9sbER1cmF0aW9uJywgMTAwMClcclxuICAgIC52YWx1ZSgnZHVTY3JvbGxPZmZzZXQnLCAxMDApXHJcbiAgICAudmFsdWUoJ2R1U2Nyb2xsQWN0aXZlQ2xhc3MnLCAnYWN0aXZlLXNsaWRlJylcclxuICAgIC8vIC52YWx1ZSgnZHVTY3JvbGxFYXNpbmcnLCBpbnZlcnRlZEVhc2luZ0Z1bmN0aW9uKVxyXG4gICAgLmNvbmZpZyhjb25maWd1cmUpXHJcbiAgICAucnVuKHJ1bkJsb2NrKTtcclxuXHJcbiAgY29uZmlndXJlLiRpbmplY3QgPSBbJyR1cmxSb3V0ZXJQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsICckaHR0cFByb3ZpZGVyJ107XHJcblxyXG4gIGZ1bmN0aW9uIGNvbmZpZ3VyZSgkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyLCAkaHR0cFByb3ZpZGVyKSB7XHJcbiAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLndpdGhDcmVkZW50aWFscyA9IHRydWU7XHJcbiAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUoe2VuYWJsZWQ6IHRydWUsIHJlcXVpcmVCYXNlOiBmYWxzZX0pO1xyXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLzQwNCcpO1xyXG4gIH1cclxuXHJcbiAgcnVuQmxvY2suJGluamVjdCA9IFsnJHJvb3RTY29wZScsJyRzdGF0ZSddO1xyXG5cclxuICBmdW5jdGlvbiBydW5CbG9jaygkcm9vdFNjb3BlLCAkc3RhdGUpIHtcclxuICAgIC8vICRyb290U2NvcGUuJG9uKCdjbG9zZS1tb2RhbHMnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyAgICR1aWJNb2RhbFN0YWNrLmRpc21pc3NBbGwoKTtcclxuICAgIC8vIH0pO1xyXG4gICAgJHJvb3RTY29wZS5jYW5vbmljYWwgPSAnLyc7XHJcbiAgICAkcm9vdFNjb3BlLiRzdGF0ZSA9ICRzdGF0ZTtcclxuICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VFcnJvcicsIGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgIH0pO1xyXG4gICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbihldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSkge1xyXG4gICAgICAkcm9vdFNjb3BlLnBhZ2VUaXRsZSA9IHRvU3RhdGUuZGF0YSAmJiB0b1N0YXRlLmRhdGEudGl0bGUgPyB0b1N0YXRlLmRhdGEudGl0bGUgOiAndGVzdCB0YXNrJztcclxuICAgICAgYW5ndWxhci5lbGVtZW50KCdib2R5Jykuc2Nyb2xsVG9wKDApO1xyXG4gICAgfSk7XHJcbiAgICAkcm9vdFNjb3BlLmJyb2FkY2FzdFNjcm9sbEV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3Njcm9sbCcpO1xyXG4gICAgfTtcclxuICB9XHJcbn0pKGFuZ3VsYXIpO1xyXG4iLCIoZnVuY3Rpb24gKGFuZ3VsYXIpIHtcclxuICBcInVzZSBzdHJpY3RcIjtcclxuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgnSG9tZVNlcnZpY2UnLCBIb21lU2VydmljZSk7XHJcblxyXG4gIEhvbWVTZXJ2aWNlLiRpbmplY3QgPSBbXTtcclxuXHJcbiAgZnVuY3Rpb24gSG9tZVNlcnZpY2UoKSB7XHJcblxyXG4gICAgdmFyIG5ld3MgPSBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgdGl0bGU6ICdQYXJ0bmVyc2hpcCBmb3IgZnV0dXJlIHdpdGhvdXQgbGllJyxcclxuICAgICAgICAgIHRpdGxlRm90bzonL2ltZy9uZXdzL25ld3MzLXRpdGxlLmpwZycsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJBd2FyZC13aW5uaW5nIGludmVzdGlnYXRpdmUgam91cm5hbGlzdCBEaWFuZSBGcmFuY2lzIHdpdGggS2lyYSBSdWRpaywgVmVyaWZpZWQsIE1hbmFnZW1lbnQgYW5kIE9wZXJhdGlvbnMsIHVuaXRlZCB0aGVpciBjb21tb24gZm9yY2VzIHRvIGRldmVsb3AgYSBwcm9qZWN0Li4uXCIsXHJcbiAgICAgICAgICBkZXRhaWxlZERlc2NyaXB0aW9uOiB7XHJcbiAgICAgICAgICAgIHBhcmFncmFwaDE6IFwiQXdhcmQtd2lubmluZyBpbnZlc3RpZ2F0aXZlIGpvdXJuYWxpc3QgRGlhbmUgRnJhbmNpcyB3aXRoIEtpcmEgUnVkaWssIFZlcmlmaWVkLCBNYW5hZ2VtZW50IGFuZCBPcGVyYXRpb25zLCB1bml0ZWQgdGhlaXIgY29tbW9uIGZvcmNlcyB0byBkZXZlbG9wIGEgcHJvamVjdCBhaW1lZCB0byBoZWxwIHBlb3BsZSB0byBmaW5kIHRydWUgc3RhdGVtZW50cyBpbiBvdXIgZmFzdC1jaGFuZ2luZyBpbmZvcm1hdGlvbiBzb2NpZXR5LlwiLFxyXG4gICAgICAgICAgICBwYXJhZ3JhcGgyOiBcIkl0IHdpbGwgYmUgYSByZWFsLXRpbWUgZmFjdCBjaGVja2luZyB0b29sIHZlcmlmeWluZyBzdGF0ZW1lbnQgYW5kIHRoZW4gcmVjZWl2aW5nIGEgcmF0aW5nIGFib3V0IHRoZSBhY2N1cmFjeSBvZiB0aGlzIOKAmGZhY3Qu4oCZIEZhY3QgY2hlY2tpbmcgZW5hYmxlcyB1cyB0byBzb3J0IHRocm91Z2ggYSB0aWRhbCB3YXZlIG9mIG1hc3NpdmUgaW5mb3JtYXRpb24gYW5kIGNvbW11bmljYXRpb24uXCJcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBkYXk6ICcnLFxyXG4gICAgICAgICAgbW9udGg6ICdKdW5lJyxcclxuICAgICAgICAgIHllYXI6ICcyMDE3JyxcclxuICAgICAgICAgIGltYWdlOiAnL2ltZy9uZXdzL25ld3MzLmpwZydcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHRpdGxlOiAnVnNldm9sb2QgRHlvbWtpbiBhYm91dCBWZXJpZmllZCBQcm90b3R5cGUnLFxyXG4gICAgICAgICAgdGl0bGVGb3RvOicvaW1nL25ld3MvbmV3czItdGl0bGUuanBnJyxcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlZlcmlmaWVkIGlzIGEgcHJvdG90eXBlIG9mIHRoZSBwcm9ncmFtIHRoYXQgY2FuIGRldGVybWluZSB3aGV0aGVyIHRoZSBuZXdzIGlzIHRydWUgb3IgZmFrZS4gVGhlIHByb2dyYW0gY2hlY2tzIHRoZSB0ZXh0IGZvciBpbmNvbnNpc3RlbmNpZXMuIFRoZSBxdWVzdGlvbiBpcy4uLlwiLFxyXG4gICAgICAgICAgZGV0YWlsZWREZXNjcmlwdGlvbjoge1xyXG4gICAgICAgICAgICBwYXJhZ3JhcGgxOiBcIlZlcmlmaWVkIGlzIGEgcHJvdG90eXBlIG9mIHRoZSBwcm9ncmFtIHRoYXQgY2FuIGRldGVybWluZSB3aGV0aGVyIHRoZSBuZXdzIGlzIHRydWUgb3IgZmFrZS4gVGhlIHByb2dyYW0gY2hlY2tzIHRoZSB0ZXh0IGZvciBpbmNvbnNpc3RlbmNpZXMuIFRoZSBxdWVzdGlvbiBpcyDigJxIb3cgdGhlIHByb2dyYW0gd29ya3M/4oCdLiBUaGVyZSBpcyBhIHNwZWNpYWwgZmllbGQgdG8gZW50ZXIgdGhlIHRleHQ6IGNsYWltcyBvciBxdW90ZXMuIEFmdGVyIGVudGVyaW5nLCB0aGUgcHJvdG90eXBlIGNvbXBhcmVzIGl0IHdpdGggb3RoZXIgd2ViIHNvdXJjZXMuXCIsXHJcbiAgICAgICAgICAgIHBhcmFncmFwaDI6IFwiVGhlIHByb2dyYW0gYW5hbHlzZXMgZGF0YSBhbmQgZmluZHMgY29uZmlybWF0aW9uIG9yIHJlZnV0YXRpb24uIEFzIHRoZSByZXN1bHQsIHdlIGdldCBpbmZvcm1hdGlvbiB0aGF0IGNhbiBjb25maXJtIG9yIHJlZnV0ZSB0aGlzIGNsYWltLiBJZiB0aGUgcmVzdWx0IHdhcyBub3QgZm91bmQsIHRoZSBjbGFpbSBpcyBub3QgY29uZmlybWVkLiBWZXJpZmllZCBnb2FsIGlzIHRvIGhlbHAgb3VyIHNvY2lldHkgdG8gaWRlbnRpZnkgdGhlIGZha2UgbmV3cyBhbmQgZmluZCB0aGUgdHJ1dGguXCJcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBkYXk6ICcnLFxyXG4gICAgICAgICAgbW9udGg6ICdNYXknLFxyXG4gICAgICAgICAgeWVhcjogJzIwMTcnLFxyXG4gICAgICAgICAgaW1hZ2U6ICcvaW1nL25ld3MvbmV3czIuanBnJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgdGl0bGU6ICdUaGUgbWVldC11cCDigJxGZWF0dXJlcyBhbmQgbW9kZWxzIG9mIE5MUFwiJyxcclxuICAgICAgICAgIHRpdGxlRm90bzonL2ltZy9uZXdzL25ld3MxLXRpdGxlLmpwZycsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbWVldC11cCAnV2hhdCBmZWF0dXJlcyBhbmQgbW9kZWxzIGRvIHdvcmsgaW4gTkxQIGFuZCB3aHknIHdhcyBoZWxkIG9uIEZlYnJ1YXJ5LCAxMCBieSBWc2V2b2xvZCBEeW9ta2luLCBMaXNwIEVuZ2luZWVyLCBpbmRlcGVuZGVudCBkZXZlbG9wZXIgYW5kIGV4cGVydCBpbiBOTFAuXCIsXHJcbiAgICAgICAgICBkZXRhaWxlZERlc2NyaXB0aW9uOiB7XHJcbiAgICAgICAgICAgIHBhcmFncmFwaDE6IFwiVGhlIG1lZXQtdXAgJ1doYXQgZmVhdHVyZXMgYW5kIG1vZGVscyBkbyB3b3JrIGluIE5MUCBhbmQgd2h5JyB3YXMgaGVsZCBvbiBGZWJydWFyeSwgMTAgYnkgVnNldm9sb2QgRHlvbWtpbiwgTGlzcCBFbmdpbmVlciwgaW5kZXBlbmRlbnQgZGV2ZWxvcGVyIGFuZCBleHBlcnQgaW4gTkxQLlwiLFxyXG4gICAgICAgICAgICBwYXJhZ3JhcGgyOiBcIlZzZXZvbG9kIHNwb2tlIGFib3V0IGxpbmVhciBtb2RlbHMsIHJhbmRvbSBmb3Jlc3QsIFJOTiwgbW9ycGhvbG9naWNhbCBmZWF0dXJlcywgMS1ob3QgZW5jb2RpbmcgYW5kIHdvcmQtZW1iZWRkaW5ncy4gTWVldC11cCB3YXMgaW50ZW5kZWQgb24gYXVkaWVuY2Ugd2l0aCBnb29kIGV4cGVyaWVuY2UgaW4gTUwsIHdobyB3YW50ZWQgdG8gbGVhcm4gbmV3IGluZm9ybWF0aW9uLlwiXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgZGF5OiAnMTAnLFxyXG4gICAgICAgICAgbW9udGg6ICdGZWJydWFyeScsXHJcbiAgICAgICAgICB5ZWFyOiAnMjAxNycsXHJcbiAgICAgICAgICBpbWFnZTogJy9pbWcvbmV3cy9uZXdzMS5qcGcnXHJcbiAgICAgICAgfVxyXG4gICAgICBdO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgbmV3czogbmV3c1xyXG4gIH07XHJcbn1cclxufSlcclxuKGFuZ3VsYXIpO1xyXG4iLCIoZnVuY3Rpb24gKGFuZ3VsYXIpIHtcclxuICBcInVzZSBzdHJpY3RcIjtcclxuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgnVGVhbVNlcnZpY2UnLCBUZWFtU2VydmljZSk7XHJcblxyXG4gIFRlYW1TZXJ2aWNlLiRpbmplY3QgPSBbXTtcclxuXHJcbiAgZnVuY3Rpb24gVGVhbVNlcnZpY2UoKSB7XHJcblxyXG4gICAgdmFyIGRpcmVjdG9ycyA9IFtcclxuICAgICAgeyBuYW1lOiAnRGlhbmUgRnJhbmNpcycsXHJcbiAgICAgICAgcG9zaXRpb246J0F1dGhvciwgUHJvZmVzc2lvbmFsIENvcnBvcmF0ZSBEaXJlY3RvciwgUHJvZmVzc29yLCBFbnRyZXByZW5ldXIsIGV4cGVydCBvbiBTaWxpY29uIFZhbGxleSwgZnV0dXJlIHRlY2hub2xvZ3knLFxyXG4gICAgICAgIGltYWdlOiAnZnJhbnNpcy5qcGcnXHJcbiAgICAgIH0sXHJcbiAgICAgIHsgbmFtZTogJ0phc29uIE1pdHVyYScsXHJcbiAgICAgICAgcG9zaXRpb246J1NlcmlhbCBWZW50dXJlIENhcGl0YWxpc3QsIFZpZXdkbGUnLFxyXG4gICAgICAgIGltYWdlOiAnamFzb24uanBnJ1xyXG4gICAgICB9LFxyXG4gICAgICB7IG5hbWU6ICdLaXJhXHRSdWRpaycsXHJcbiAgICAgICAgcG9zaXRpb246J01hbmFnZW1lbnQgYW5kIE9wZXJhdGlvbnMnLFxyXG4gICAgICAgIGltYWdlOiAna2lyYS5qcGcnXHJcbiAgICAgIH0sXHJcbiAgICAgIHsgbmFtZTogJ1ZzZXZvbG9kIER5b21raW4nLFxyXG4gICAgICAgIHBvc2l0aW9uOidXb3JsZC1DbGFzcyByZXNlYXJjaGVyLCBLeWl2IFBvbHl0ZWNobmljIGxlY3R1cmVyLCA1IHllYXJzIE5MUCB3aXRoIEdyYW1tYXJseScsXHJcbiAgICAgICAgaW1hZ2U6ICdkeW9ta2luLmpwZydcclxuICAgICAgfVxyXG4gICAgXTtcclxuICAgIHZhciB0ZWFtID0gW1xyXG4gICAgICAgIHtuYW1lOiAnVGFyYXMnLCBwb3NpdGlvbjonUmVzZWFyY2hlcicsIGltYWdlOiAndGFyYXMtc2VyZWRhLTAwMDYuanBnJ30sXHJcbiAgICAgICAge25hbWU6ICdBbGVrc2FuZHInLCBwb3NpdGlvbjonRnVsbCBTdGFjayBEZXZlbG9wZXInLCBpbWFnZTogJ2FsZXgtbGFwc2h5bi5qcGcnfVxyXG4gICAgICBdO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHRlYW06IHRlYW0sXHJcbiAgICAgIGRpcmVjdG9yczogZGlyZWN0b3JzXHJcbiAgICB9O1xyXG4gIH1cclxufSkoYW5ndWxhcik7XHJcbiIsIihmdW5jdGlvbiAoYW5ndWxhcikge1xyXG4gIFwidXNlIHN0cmljdFwiO1xyXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdXaW5kb3dFdmVudHNTZXJ2aWNlJywgV2luZG93RXZlbnRzU2VydmljZSk7XHJcblxyXG4gIFdpbmRvd0V2ZW50c1NlcnZpY2UuJGluamVjdCA9IFsnJHdpbmRvdyddO1xyXG5cclxuICBmdW5jdGlvbiBXaW5kb3dFdmVudHNTZXJ2aWNlKCR3aW5kb3cpIHtcclxuICAgIHZhciBhcGkgPSB7XHJcbiAgICAgIHRocm90dGxlVGltZTogMTAwLFxyXG4gICAgICBsaXN0ZW46IGxpc3RlblxyXG4gICAgfTtcclxuXHJcbiAgICAvL2xpc3RlbmVyIHVwZGF0ZXNcclxuICAgIGZ1bmN0aW9uIGxpc3Rlbihpc09uLCB0eXBlLCBtZXRob2QsIHRpbWUpIHtcclxuXHJcbiAgICAgIC8vY2xlYW4gdGltZSwgZGV0ZXJtaW5lIGxpc3RlbmVyIHR5cGVcclxuICAgICAgdmFyIGRlYm91bmNlVGltZSA9IGlzTmFOKHRpbWUpID8gYXBpLnRocm90dGxlVGltZSA6IHRpbWUsXHJcbiAgICAgICAgbGlzdGVuZXJUeXBlID0gaXNPbiA/ICdhZGRFdmVudExpc3RlbmVyJyA6ICdyZW1vdmVFdmVudExpc3RlbmVyJztcclxuXHJcbiAgICAgIC8vdXBkYXRlIHRocm90dGxlZCBsaXN0ZW5lclxyXG4gICAgICAkd2luZG93W2xpc3RlbmVyVHlwZV0odHlwZSwgXy50aHJvdHRsZShtZXRob2QsIGRlYm91bmNlVGltZSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vaW50ZXJmYWNlXHJcbiAgICByZXR1cm4gYXBpO1xyXG4gIH1cclxufSkoYW5ndWxhcik7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmRpcmVjdGl2ZSgnb25TY3JvbGwnLCBmdW5jdGlvbigkdGltZW91dCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHNjb3BlOiB7XHJcbiAgICAgIG9uU2Nyb2xsOiAnJm9uU2Nyb2xsJyxcclxuICAgIH0sXHJcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCkge1xyXG4gICAgICB2YXIgc2Nyb2xsRGVsYXkgPSAyNTAsXHJcbiAgICAgICAgc2Nyb2xsVGhyb3R0bGVUaW1lb3V0LFxyXG4gICAgICAgIHRocm90dGxlZCA9IGZhbHNlLFxyXG4gICAgICAgIHNjcm9sbEhhbmRsZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIGlmICghdGhyb3R0bGVkKSB7XHJcbiAgICAgICAgICAgIHNjb3BlLm9uU2Nyb2xsKCk7XHJcbiAgICAgICAgICAgIHRocm90dGxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHNjcm9sbFRocm90dGxlVGltZW91dCA9ICR0aW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgdGhyb3R0bGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0sIHNjcm9sbERlbGF5KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgZWxlbWVudC5vbihcInNjcm9sbFwiLCBzY3JvbGxIYW5kbGVyKTtcclxuXHJcbiAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBlbGVtZW50Lm9mZignc2Nyb2xsJywgc2Nyb2xsSGFuZGxlcik7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH07XHJcbn0pO1xyXG4iLCIoZnVuY3Rpb24oYW5ndWxhcikge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignTGFuZGluZ0NvbnRyb2xsZXInLCBMYW5kaW5nQ29udHJvbGxlcik7XHJcblxyXG4gIExhbmRpbmdDb250cm9sbGVyLiRpbmplY3QgPSBbJyRodHRwJywgJ2xpbWl0VG9GaWx0ZXInXTtcclxuICBmdW5jdGlvbiBMYW5kaW5nQ29udHJvbGxlcigkaHR0cCwgbGltaXRUb0ZpbHRlcikge1xyXG4gICAgdmFyIG1haW4gPSB0aGlzO1xyXG5cclxuICAgIG1haW4uZm9ybVN1Ym1pdCA9IGZvcm1TdWJtaXQ7XHJcbiAgICBtYWluLmVycm9yID0gJ3NvbWV0aGluZyB3cm9uZyc7XHJcbiAgICBtYWluLmZvcm1EYXRhID0ge307XHJcbiAgICBtYWluLnNob3dTdGVwMiA9IGZhbHNlO1xyXG4gICAgbWFpbi5zaG93U3RlcDMgPSBmYWxzZTtcclxuXHJcbiAgICBtYWluLm1pblllYXJzID0gNzY3MTtcclxuICAgIG1haW4uZGlmNzB5ZXJzID0gMjU1Njk7XHJcbiAgICBtYWluLnRvZGF5RGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAvLyBtYWluLnRvZGF5TVMgPSBtYWluLnRvZGF5RGF0ZS5nZXRUaW1lKCk7XHJcbiAgICBtYWluLnRvZGF5RGF5cyA9ICBtYWluLnRvZGF5RGF0ZS5nZXRUaW1lKCkgLyA4NjQwMDAwMDtcclxuICAgIG1haW4uYWdlQ2hlY2sgPSBhZ2VDaGVjaztcclxuICAgIG1haW4uYWdlSW52YWxpZCA9IGZhbHNlO1xyXG5cclxuICAgIGZ1bmN0aW9uIGFnZUNoZWNrKCkge1xyXG4gICAgICBtYWluLmlublN0ciA9IG1haW4uZm9ybURhdGEuaW5uLnRvU3RyaW5nKCkuc3Vic3RyaW5nKDAsIDUpO1xyXG4gICAgICBtYWluLmFnZUNoZWNrUmVzID0gbWFpbi50b2RheURheXMgKyBtYWluLmRpZjcweWVycyAtIG1haW4uaW5uU3RyO1xyXG4gICAgICBpZiAobWFpbi5hZ2VDaGVja1JlcyA+ICBtYWluLm1pblllYXJzKSB7XHJcbiAgICAgICAgbWFpbi5hZ2VJbnZhbGlkID0gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH0gICBlbHNlIHtcclxuICAgICAgICBtYWluLmFnZUludmFsaWQgPSB0cnVlO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGZvcm1TdWJtaXQoKSB7XHJcbiAgICAgICRodHRwKHtcclxuICAgICAgICAgIHVybDogJy8nLFxyXG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgIGRhdGE6IG1haW4uZm9ybURhdGEsXHJcbiAgICAgICAgICBoZWFkZXJzOiB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD11dGYtODsnfVxyXG4gICAgICAgICAgfSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICBhbGVydCgnZGF0YSBzZW50Jyk7XHJcbiAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKCkge1xyXG4gICAgICAgICAgICAgIGFsZXJ0KFwic29tZXRoaW5nIHdyb25nXCIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBtYWluLmdldENpdGllcyA9IGdldENpdGllcztcclxuICAgIGZ1bmN0aW9uIGdldENpdGllcygpIHtcclxuXHJcbiAgICAgICRodHRwLmdldChcImh0dHA6Ly9nZC5nZW9ieXRlcy5jb20vQXV0b0NvbXBsZXRlQ2l0eT9jYWxsYmFjaz0/JnE9XCIgKyBtYWluLmZvcm1EYXRhLmNpdHkpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xyXG4gICAgICAgIC8vIG1haW4uY2l0aWVzID0gbGltaXRUb0ZpbHRlcihyZXNwb25zZS5kYXRhLCAxNSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbn0pKGFuZ3VsYXIpO1xyXG4iLCIoZnVuY3Rpb24oYW5ndWxhcikge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29uZmlnKGxhbmRpbmdSb3V0ZSk7XHJcbiAgbGFuZGluZ1JvdXRlLiRpbmplY3QgPSBbJyRzdGF0ZVByb3ZpZGVyJ107XHJcblxyXG4gIGZ1bmN0aW9uIGxhbmRpbmdSb3V0ZSgkc3RhdGVQcm92aWRlcikge1xyXG4gICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2xhbmRpbmcnLCB7XHJcbiAgICAgIGFic3RyYWN0OiB0cnVlLFxyXG4gICAgICB0ZW1wbGF0ZVVybDogJy92aWV3L21vZHVsZXMvbGFuZGluZy9sYW5kaW5nLmh0bWwnLFxyXG4gICAgICBjb250cm9sbGVyOiAnTGFuZGluZ0NvbnRyb2xsZXInLFxyXG4gICAgICBjb250cm9sbGVyQXM6ICdtYWluJ1xyXG5cclxuICAgIH0pO1xyXG4gIH1cclxufSkoYW5ndWxhcik7XHJcbiIsIihmdW5jdGlvbiAoYW5ndWxhcikge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignTGFuZGluZ0hvbWVDb250cm9sbGVyJywgTGFuZGluZ0hvbWVDb250cm9sbGVyKTtcclxuXHJcblxyXG4gIExhbmRpbmdIb21lQ29udHJvbGxlci4kaW5qZWN0ID0gWyckZG9jdW1lbnQnLCAnJHNjb3BlJywgJyR3aW5kb3cnLCAnV2luZG93RXZlbnRzU2VydmljZScsXHJcbiAgICAnSG9tZVNlcnZpY2UnLCAnJHN0YXRlUGFyYW1zJywgJyR0aW1lb3V0JywgJ1RlYW1TZXJ2aWNlJ107XHJcbiAgZnVuY3Rpb24gTGFuZGluZ0hvbWVDb250cm9sbGVyKCRkb2N1bWVudCwgJHNjb3BlLCAkd2luZG93LCBXaW5kb3dFdmVudHNTZXJ2aWNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIb21lU2VydmljZSwgJHN0YXRlUGFyYW1zLCAkdGltZW91dCwgVGVhbVNlcnZpY2UpIHtcclxuICAgIHZhciB2bSA9IHRoaXM7XHJcblxyXG4gICAgdm0uc2Nyb2xsVG8gPSBzY3JvbGxUbztcclxuXHJcblxyXG4gICAgZnVuY3Rpb24gc2Nyb2xsVG8oZWxlbWVudEluZGV4KSB7XHJcbiAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkZG9jdW1lbnQuc2Nyb2xsVG9FbGVtZW50QW5pbWF0ZWQodm0uc2VjdGlvbnNbZWxlbWVudEluZGV4XS5lbGVtZW50LCAwKTtcclxuICAgICAgfSwgMTAwKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRFbGVtZW50c0hlaWdodCgpIHtcclxuICAgICAgdm0uZXZlbnRzR3JpZEhlaWdodCA9IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXZlbnRzLWdyaWQnKSlbMF0uY2xpZW50SGVpZ2h0O1xyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG59KShhbmd1bGFyKTtcclxuIiwiKGZ1bmN0aW9uKGFuZ3VsYXIpIHtcclxuICAndXNlIHN0cmljdCc7XHJcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbmZpZyhsYW5kaW5nSG9tZVJvdXRlKTtcclxuICBsYW5kaW5nSG9tZVJvdXRlLiRpbmplY3QgPSBbJyRzdGF0ZVByb3ZpZGVyJ107XHJcblxyXG4gIGZ1bmN0aW9uIGxhbmRpbmdIb21lUm91dGUoJHN0YXRlUHJvdmlkZXIpIHtcclxuICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdsYW5kaW5nLmhvbWUnLCB7XHJcbiAgICAgIHVybDogJy8nLFxyXG4gICAgICB0ZW1wbGF0ZVVybDogJy92aWV3L21vZHVsZXMvbGFuZGluZy9ob21lL2hvbWUuaHRtbCcsXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdMYW5kaW5nSG9tZUNvbnRyb2xsZXInLFxyXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXHJcbiAgICAgIGRhdGE6IHtcclxuICAgICAgICB0aXRsZTogJ3Rlc3QgdGFzaydcclxuICAgICAgfSxcclxuICAgICAgcGFyYW1zOiB7XHJcbiAgICAgICAgdGFyZ2V0U2VjdGlvbk5hbWU6ICdtYWluJ1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn0pKGFuZ3VsYXIpO1xyXG4iLCIoZnVuY3Rpb24oYW5ndWxhcikge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignTGFuZGluZ1BhZ2UyQ29udHJvbGxlcicsIExhbmRpbmdQYWdlMkNvbnRyb2xsZXIpO1xyXG5cclxuICBMYW5kaW5nUGFnZTJDb250cm9sbGVyLiRpbmplY3QgPSBbJyRkb2N1bWVudCcsICdXaW5kb3dFdmVudHNTZXJ2aWNlJywgJyR3aW5kb3cnLCAnJHNjb3BlJywgJyR0aW1lb3V0JyxcclxuICAnSG9tZVNlcnZpY2UnLCAnJHN0YXRlUGFyYW1zJ107XHJcbiAgZnVuY3Rpb24gTGFuZGluZ1BhZ2UyQ29udHJvbGxlcigkZG9jdW1lbnQsIFdpbmRvd0V2ZW50c1NlcnZpY2UsICR3aW5kb3csICRzY29wZSwgJHRpbWVvdXQsXHJcbiAgICAgSG9tZVNlcnZpY2UsICRzdGF0ZVBhcmFtcykge1xyXG4gICAgdmFyIHZtID0gdGhpcztcclxuXHJcbiAgICB2bS5zY3JvbGxZID0gMDtcclxuICAgIHZtLm1lbnVJc09wZW4gPSBmYWxzZTtcclxuICAgIHZtLnRvZ2dsZU1vYmlsZU1lbnUgPSB0b2dnbGVNb2JpbGVNZW51O1xyXG4gICAgdm0uc2Nyb2xsVG8gPSBzY3JvbGxUbztcclxuICAgIHZtLndpbmRvd1dpZHRoID0gJHdpbmRvdy5pbm5lcldpZHRoO1xyXG4gICAgdm0ud2luZG93SGVpZ2h0ID0gJHdpbmRvdy5pbm5lckhlaWdodDtcclxuICAgIHZtLndpbmRvd1kgPSAwO1xyXG4gICAgdm0ubmV3cyA9IEhvbWVTZXJ2aWNlLm5ld3M7XHJcbiAgICB2bS5uZXdzTGVmdE91dCA9IHZtLndpbmRvd1dpZHRoICogMC4yOTtcclxuICAgIHZtLm5ld3NJdGVtV2lkdGggPSA0MDA7XHJcbiAgICB2bS5uZXdzTGlzdFdpZHRoID0gdm0ubmV3cy5sZW5ndGggKiB2bS5uZXdzSXRlbVdpZHRoO1xyXG4gICAgdm0ubmV3c0xlZnQgPSBuZXdzTGVmdDtcclxuICAgIHZtLm5ld3NSaWdodCA9IG5ld3NSaWdodDtcclxuICAgIHZtLm9wZW5OZXdzID0ge307XHJcbiAgICB2bS5kZXRhaWxlZE5ld3NPcGVuZWQgPSBmYWxzZTtcclxuICAgIHZtLm5ld3NEZXRhbHNUb2dnbGUgPSBuZXdzRGV0YWxzVG9nZ2xlO1xyXG4gICAgdm0ubGVmdEFycm93SG92ZXJlZCA9IGZhbHNlO1xyXG4gICAgdm0ucmlnaHRBcnJvd0hvdmVyZWQgPSBmYWxzZTtcclxuXHJcbiAgICBXaW5kb3dFdmVudHNTZXJ2aWNlLmxpc3Rlbih0cnVlLCAnc2Nyb2xsJywgZGVmaW5lU2Nyb2xsWSk7XHJcblxyXG4gICAgZnVuY3Rpb24gZGVmaW5lU2Nyb2xsWSgpIHtcclxuICAgICAgdm0uc2Nyb2xsWSA9ICR3aW5kb3cuc2Nyb2xsWTtcclxuICAgICAgJHNjb3BlLiRhcHBseSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNjcm9sbFRvKHNlY3Rpb25OYW1lKSB7XHJcbiAgICAgICRkb2N1bWVudC5zY3JvbGxUb0VsZW1lbnRBbmltYXRlZCh2bS5zZWN0aW9uc1tzZWN0aW9uTmFtZV0uZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdG9nZ2xlTW9iaWxlTWVudSgpIHtcclxuICAgICAgdm0ubWVudUlzT3BlbiA9ICF2bS5tZW51SXNPcGVuO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBpZiAodm0ud2luZG93V2lkdGggPCA3MDApIHtcclxuICAgICAgdm0ubmV3c0xlZnRPdXQgPSAyO1xyXG4gICAgICB2bS5uZXdzSXRlbVdpZHRoID0gMzMwO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNoZWNrV2luZG93V2lkdGgoKXtcclxuICAgICAgICB2bS53aW5kb3dXaWR0aCA9ICR3aW5kb3cuaW5uZXJXaWR0aDtcclxuICAgICAgICAkdGltZW91dCggY2hlY2tXaW5kb3dXaWR0aCwgMjAwICk7XHJcbiAgICB9XHJcbiAgICBjaGVja1dpbmRvd1dpZHRoKCk7XHJcblxyXG4gICAgZnVuY3Rpb24gZXZlbnREZXRhaWxzKGV2ZW50KSB7XHJcbiAgICAgIHZtLnNlbGVjdGVkRXZlbnQgPSBldmVudDtcclxuICAgICAgdm0uc2hvd0V2ZW50RGV0YWlscyA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbmV3c0xlZnQoKSB7XHJcbiAgICAgIGlmICh2bS53aW5kb3dXaWR0aCA+IDcwMCkge1xyXG4gICAgICAgIGlmKCAgKHZtLm5ld3NMaXN0V2lkdGggKyB2bS5uZXdzTGVmdE91dCkgPCAodm0ubmV3c0l0ZW1XaWR0aCAqIDIuNSkgICkge1xyXG4gICAgICAgICAgdm0ubmV3c0xlZnRPdXQgPSB2bS53aW5kb3dXaWR0aCAqIDAuMjk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHZtLm5ld3NMZWZ0T3V0IC09IHZtLm5ld3NJdGVtV2lkdGg7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmKCAgKHZtLm5ld3NMaXN0V2lkdGggKyB2bS5uZXdzTGVmdE91dCkgPCAodm0ubmV3c0l0ZW1XaWR0aCoyLjUpICApIHtcclxuICAgICAgICAgIHZtLm5ld3NMZWZ0T3V0ID0gMjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdm0ubmV3c0xlZnRPdXQgLT0gdm0ubmV3c0l0ZW1XaWR0aDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBuZXdzUmlnaHQoKSB7XHJcbiAgICAgIGlmICh2bS53aW5kb3dXaWR0aCA+IDcwMCkge1xyXG4gICAgICAgIGlmKCAgKHZtLm5ld3NMZWZ0T3V0L3ZtLndpbmRvd1dpZHRoKSA+IDAuNzMgICkge1xyXG4gICAgICAgICAgdm0ubmV3c0xlZnRPdXQgPSB2bS53aW5kb3dXaWR0aCAqIDAuMjk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHZtLm5ld3NMZWZ0T3V0ICs9IHZtLm5ld3NJdGVtV2lkdGg7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmKCAgdm0ubmV3c0xlZnRPdXQgPCAzICYmIHZtLm5ld3NMZWZ0T3V0ID4gLTEwMCAgKSB7XHJcbiAgICAgICAgICB2bS5uZXdzTGVmdE91dCA9IC0gdm0ubmV3c0l0ZW1XaWR0aCAqICh2bS5uZXdzLmxlbmd0aCAtIDEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB2bS5uZXdzTGVmdE91dCArPSB2bS5uZXdzSXRlbVdpZHRoO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG5ld3NEZXRhbHNUb2dnbGUoKSB7XHJcbiAgICAgICB2bS5kZXRhaWxlZE5ld3NPcGVuZWQgPSAhdm0uZGV0YWlsZWROZXdzT3BlbmVkO1xyXG4gICAgfVxyXG5cclxuICB9XHJcbn0pKGFuZ3VsYXIpO1xyXG4iLCIoZnVuY3Rpb24oYW5ndWxhcikge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29uZmlnKGxhbmRpbmdQYWdlMlJvdXRlKTtcclxuICBsYW5kaW5nUGFnZTJSb3V0ZS4kaW5qZWN0ID0gWyckc3RhdGVQcm92aWRlciddO1xyXG5cclxuICBmdW5jdGlvbiBsYW5kaW5nUGFnZTJSb3V0ZSgkc3RhdGVQcm92aWRlcikge1xyXG4gICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2xhbmRpbmcucGFnZTInLCB7XHJcbiAgICAgIHVybDogJy9wYWdlMicsXHJcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXcvbW9kdWxlcy9sYW5kaW5nL3BhZ2UyL3BhZ2UyLmh0bWwnLFxyXG4gICAgICBjb250cm9sbGVyOiAnTGFuZGluZ1BhZ2UyQ29udHJvbGxlcicsXHJcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIHRpdGxlOiAncGFnZSAyJ1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn0pKGFuZ3VsYXIpO1xyXG4iLCIoZnVuY3Rpb24oYW5ndWxhcikge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignTGFuZGluZ1BhZ2UzQ29udHJvbGxlcicsIExhbmRpbmdQYWdlM0NvbnRyb2xsZXIpO1xyXG5cclxuICBMYW5kaW5nUGFnZTNDb250cm9sbGVyLiRpbmplY3QgPSBbJyRkb2N1bWVudCcsICdXaW5kb3dFdmVudHNTZXJ2aWNlJywgJyR3aW5kb3cnLCAnJHNjb3BlJywgJyR0aW1lb3V0JyxcclxuICAnVGVhbVNlcnZpY2UnLCAnJHN0YXRlUGFyYW1zJ107XHJcbiAgZnVuY3Rpb24gTGFuZGluZ1BhZ2UzQ29udHJvbGxlcigkZG9jdW1lbnQsIFdpbmRvd0V2ZW50c1NlcnZpY2UsICR3aW5kb3csICRzY29wZSwgJHRpbWVvdXQsXHJcbiAgICAgVGVhbVNlcnZpY2UsICRzdGF0ZVBhcmFtcykge1xyXG4gICAgdmFyIHZtID0gdGhpcztcclxuXHJcbiAgICB2bS5zY3JvbGxZID0gMDtcclxuICAgIHZtLm1lbnVJc09wZW4gPSBmYWxzZTtcclxuICAgIHZtLnRvZ2dsZU1vYmlsZU1lbnUgPSB0b2dnbGVNb2JpbGVNZW51O1xyXG4gICAgdm0uc2Nyb2xsVG8gPSBzY3JvbGxUbztcclxuICAgIHZtLndpbmRvd1dpZHRoID0gJHdpbmRvdy5pbm5lcldpZHRoO1xyXG4gICAgdm0ud2luZG93SGVpZ2h0ID0gJHdpbmRvdy5pbm5lckhlaWdodDtcclxuICAgIHZtLndpbmRvd1kgPSAwO1xyXG4gICAgdm0uZGlyZWN0b3JzID0gVGVhbVNlcnZpY2UuZGlyZWN0b3JzO1xyXG4gICAgdm0uc3RhZmYgPSBUZWFtU2VydmljZS50ZWFtO1xyXG5cclxuICAgIFdpbmRvd0V2ZW50c1NlcnZpY2UubGlzdGVuKHRydWUsICdzY3JvbGwnLCBkZWZpbmVTY3JvbGxZKTtcclxuXHJcbiAgICBmdW5jdGlvbiBkZWZpbmVTY3JvbGxZKCkge1xyXG4gICAgICB2bS5zY3JvbGxZID0gJHdpbmRvdy5zY3JvbGxZO1xyXG4gICAgICAkc2NvcGUuJGFwcGx5KCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gc2Nyb2xsVG8oc2VjdGlvbk5hbWUpIHtcclxuICAgICAgJGRvY3VtZW50LnNjcm9sbFRvRWxlbWVudEFuaW1hdGVkKHZtLnNlY3Rpb25zW3NlY3Rpb25OYW1lXS5lbGVtZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB0b2dnbGVNb2JpbGVNZW51KCkge1xyXG4gICAgICB2bS5tZW51SXNPcGVuID0gIXZtLm1lbnVJc09wZW47XHJcbiAgICB9XHJcblxyXG4gIH1cclxufSkoYW5ndWxhcik7XHJcbiIsIihmdW5jdGlvbihhbmd1bGFyKSB7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb25maWcobGFuZGluZ1BhZ2UzUm91dGUpO1xyXG4gIGxhbmRpbmdQYWdlM1JvdXRlLiRpbmplY3QgPSBbJyRzdGF0ZVByb3ZpZGVyJ107XHJcblxyXG4gIGZ1bmN0aW9uIGxhbmRpbmdQYWdlM1JvdXRlKCRzdGF0ZVByb3ZpZGVyKSB7XHJcbiAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnbGFuZGluZy5wYWdlMycsIHtcclxuICAgICAgdXJsOiAnL3BhZ2UzJyxcclxuICAgICAgdGVtcGxhdGVVcmw6ICcvdmlldy9tb2R1bGVzL2xhbmRpbmcvcGFnZTMvcGFnZTMuaHRtbCcsXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdMYW5kaW5nUGFnZTNDb250cm9sbGVyJyxcclxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxyXG4gICAgICBkYXRhOiB7XHJcbiAgICAgICAgdGl0bGU6ICdwYWdlIDMnXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufSkoYW5ndWxhcik7XHJcbiJdfQ==
